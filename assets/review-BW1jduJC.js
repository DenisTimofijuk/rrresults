import{g as E,d as C}from"./errorHandler-JPHUPlNg.js";function v(e,d){const n=new URL(window.location.href);n.searchParams.set(e,d),window.history.pushState({},"",n)}function b(e){return new URLSearchParams(window.location.search).get(e)}async function f(e,d,n){try{const t=await E(`./mock/categories.json?y=${d}`);n.innerHTML="";const r=document.createElement("option");r.value="",r.textContent="----",n.appendChild(r),n.value="",t.forEach(m=>{const s=document.createElement("option");s.value=m.id.toString(),s.textContent=m.name,n.appendChild(s)})}catch{C()}finally{e==null||e.classList.add("hide")}}function x(e){const d=document.createElement("table");d.classList.add("table","table-hover","table-bordered","table-sm");const n=document.createElement("thead");n.classList.add("table-light");const t=document.createElement("tr"),r=Object.keys(e[0]);if(r.forEach(s=>{const i=document.createElement("th");i.textContent=s,t.appendChild(i)}),e.some(s=>s.hasOwnProperty("actions"))){const s=document.createElement("th");s.textContent="Actions",t.appendChild(s)}n.appendChild(t),d.appendChild(n);const m=document.createElement("tbody");return e.forEach((s,i)=>{const p=document.createElement("tr");if(r.forEach(l=>{const c=document.createElement("td"),a=s[l];if(l==="observation-url"&&a){const o=document.createElement("a");o.href=a.toString(),o.textContent="iNaturalist",o.target="_blank",c.appendChild(o)}else if(l==="points"){const o=document.createElement("div");o.classList.add("points-radio-group");const u=document.createElement("input");u.type="hidden",u.name="points",u.value=(a==null?void 0:a.toString())||"0",u.dataset.rowIndex=i.toString(),o.appendChild(u),[0,.5,1].forEach(g=>{const h=document.createElement("input");h.type="radio",h.classList.add("form-check-input"),h.name=`points-radio-${i}`,h.id=`points-${i}-${g}`,h.value=g.toString(),h.checked=parseFloat(a.toString())===g,h.addEventListener("change",()=>{u.value=g.toString(),s.points=g});const y=document.createElement("label");y.classList.add("form-check-label","hover-pointer"),y.htmlFor=`points-${i}-${g}`,y.textContent=g.toString(),y.appendChild(h),o.appendChild(y)}),c.appendChild(o)}else if(l==="expert_review"){const o=document.createElement("textarea");o.value=(a==null?void 0:a.toString())||"",o.rows=2,o.cols=50,c.appendChild(o)}else c.textContent=(a==null?void 0:a.toString())||"";p.appendChild(c)}),s.hasOwnProperty("actions")){const l=document.createElement("td"),c=document.createElement("button");c.textContent="Edit",c.classList.add("btn","btn-sm","btn-primary","me-1"),c.addEventListener("click",()=>{console.log("Edit row:",i)}),l.appendChild(c);const a=document.createElement("button");a.textContent="Delete",a.classList.add("btn","btn-sm","btn-danger"),a.addEventListener("click",()=>{console.log("Delete row:",i),p.remove()}),l.appendChild(a),p.appendChild(l)}m.appendChild(p)}),d.appendChild(m),d}async function L(e,d,n,t){try{e==null||e.classList.remove("hide");const r=await E(`./mock/observations.json?y=${n}&c=${t}`),m=x(r);d.appendChild(m)}catch{C()}finally{e==null||e.classList.add("hide")}}(async()=>{const e=document.getElementById("loader-wrapper"),d=document.getElementById("get-data"),n=document.getElementById("year-selected"),t=document.getElementById("category-selected"),r=document.getElementById("results"),m=document.getElementById("year-place-holder"),s=document.getElementById("category-place-holder");e==null||e.classList.remove("hide");try{(await E("./mock/years.json")).forEach(a=>{const o=document.createElement("option");o.value=a.toString(),o.textContent=a.toString(),n.appendChild(o)})}catch{C()}finally{e==null||e.classList.add("hide")}n.addEventListener("change",async()=>{const c=n.value;c&&(m.textContent=c,s.textContent="",e==null||e.classList.remove("hide"),f(e,c,t))}),t.addEventListener("change",async()=>{s.textContent=t.options[t.selectedIndex].text,d.disabled=t.value===""}),d.addEventListener("click",async()=>{!n.value||!t.value||(L(e,r,n.value,t.value),e==null||e.classList.add("hide"),v("year",n.value),v("category",t.value))});const i=b("year"),p=b("category");i&&(n.value=i,m.textContent=i,await f(e,i,t)),p&&(t.value=p,s.textContent=t.options[t.selectedIndex].text,d.disabled=t.value===""),i&&p?(d.disabled=!1,L(e,r,n.value,t.value)):d.disabled=!0;const l=document.getElementById("only-with-comments");l.addEventListener("change",()=>{const c=r.querySelector("table");c&&c.querySelectorAll("tr").forEach(o=>{const u=o.querySelector("textarea");u&&o.classList.toggle("hide",l.checked&&u.value==="")})})})();
